---
title: "Estimation"
author: "KANE SEYDOU"
date: "08/10/2020"
output: html_document
---

```{r setup, include=FALSE}

knitr::opts_chunk$set(echo = TRUE)
```

```{r}

```

# IMPOPRTATION DES DONNEES

```{r}
Data <- read.csv( file.choose(),
                  head= TRUE,
                  sep= ';')
head(Data)
```




```{r}

str(Data)
data.frame( t(matrix(summary(Data))))
x<-table(summary(Data))
#x[3]
#x<-data.frame(z=c("a","b","c","r"),i=c(1,2,3,5))
#x[3,2]
```
Notre jeu de données a 436 observations et 4 variables.

## 1.Traitement univarié:

```{r}

#summary(Data)

```



# 1.1 Etude de la distribition de nos differentes variables
### 1.1.1 Representation graphique ( Histogramme )

Voyons ce que nous donne l'estimation de la loi de distribution graphiquement(on conserve la distribution normale en bleu et celle de log-normale en rouge )


```{r}
par (mfrow= c(2,2))
hist(Data$CG_Freedent,
     main =  " CG_Freeden  ",
     xlab = " Taille (nm) ",
     ylab = "",
     prob=T, breaks = 20 )

curve(dnorm (x,mean(Data$CG_Freedent,
                    na.rm = T),
             sd(Data$CG_Freedent,
             na.rm = T)), 
             col="lightslateblue",
             type="l",
             lwd=2, 
              add= T)
curve(dlnorm (x,mean(log(Data$CG_Freedent), 
                     na.rm = T),
                     sd(log(Data$CG_Freedent),
                     na.rm = T)),
                     col="red",
                     type="l",
                     lwd=2, 
                     add= T)

hist(Data$CeO2.4,
     main =  " Ceo2.4  ",
     xlab = " Taille (nm)",
     ylab = "",
     prob=T, breaks = 20 )
curve(dnorm(x,mean(Data$CeO2.4,
                   na.rm = T),
                   sd(Data$CeO2.4,
                    na.rm = T)),
                   col="lightslateblue", 
                   type="l",
                   lwd=2, add= T)

hist(Data$R711_PLL, 
     main =  " R711_PLL  ",
     xlab = " Taille (nm) ", ylab = "",prob=T, breaks = 25 )
curve(dnorm(x,mean(Data$R711_PLL,
                   na.rm = T),
                   sd(Data$R711_PLL,
                   na.rm = T)),
                   col="lightslateblue",
                   type="l", 
                   lwd=2, 
                   add= T)

hist(Data$TiO2, main =  " Tio2  ",
       xlab = " Taille (nm) ", 
       ylab = "",
       prob=T , breaks = 20)

curve(dnorm(x,mean(Data$TiO2,
                   na.rm = T),
                   sd(Data$TiO2,
                   na.rm = T)), 
                   col="lightslateblue",
                   type="l", 
                   lwd=2, 
                   add= T)

```


## 2.Estimationion de la médiane des diamètres de nos differents échantillons:
### 2.1 Simulation
  
fonction de Simulation des Xi suivant une loi normale de moyenne X_i et d'ecart type 2.01 nm

```{r}

f_sim<-function(df) {
      X<-NULL
      for (i in 1:length(df) ) { 
              X[i] <- rnorm (1,
                             df[i],
                             2.01)
      }
      return (X)
}
```

## Une fonctionréalisation 
Cette fonction nous donne la Matrice de nos realisation de taille (n,M) ou n est la taille de l'echantillon et M le nombre de realisation

```{r}

M_realisation_<-function (df,M) {
            y<-replicate(M,f_sim(df))
            M_<-data.frame (y)
            return (M_)
          } 
```

### fonction mediane
Cette fonction calcule la mediane de chaque colonne i.e après chaque simulation on obtient n variable simulée donc nous renvois la mediane de ces n variables simulées

```{r}

Median_<-function(M_) {
            Y<-NULL
            for (i in 1:length(M_)) {
                Y[i]<-median(M_[,i])
            }
          return (Y)
}

```

### 2.1.2 Definition d'une fonction estimation_ 

Cette fonction nous donne le resumé, c'est à dire la moyenne qui va etre notre estimateur de la mediane et l'écart type de notre simulation réalisée.

```{r}

Estimation_<-function(x){
    moyenne_<-mean(x)
    e_c<-sqrt(var(x))
    
    #q.ech<-x[0.95*length(x)] # quantile de l'echantillon.
    born_inf<-quantile(x,probs = 0.025)
    born_sup<-quantile(x,probs = 0.975)
    M<-matrix(c(moyenne_,
                e_c,
                born_inf,
                born_sup))
  
  
  return (M)
}

```


## Data_Mars_2017

## Pour l'echantillon 1
On fixe le tirage à 100000

```{r}
M<-1e5
df1 <- subset(Data[,1],
              !is.na(Data[,1]))

M1<-M_realisation_(df1,M)

y1<-Median_(M1)

#head(M1) # On   affiche les 6 premières lignes de notre matrice
#head(M1$X1)# Notre première colonne colonne simulée.

DF<-rbind(M1,y1) # sous chaque colonne trouvé, on met en dessous sa mediane correspondante. 
#head(DF)
Me1<- Estimation_(y1) # Estimation de la mediane 
colnames(Me1)<- "CG_Freedent"
rownames(Me1)<-c("M",
                 "Ecart_type",
                 " born_inf", 
                 " born_sup")
Me1<-data.frame(Me1)
Me1
#head(M1) # matrice
```


Nous avons une estimatiion de la médiane de 141.26 nm et d'ecart type 0.73 nm

## L'histrogramme de notre simulation réalisée est la suivante

```{r}
hist(y1,
     probability = T,
     breaks = 35,
     col= ' gray ',
     xlab = 'médiane (nm)', 
     main = "CG_Freedent")

abline( v=141.48 , col= "red")
abline( v=139.74 , col= "blue")
abline( v= 143.24 , col= "blue")
legend("topleft", legend = c("y_inf", "Estimation", "y_sup"), fill = c("blue", "red", "blue")) 

#curve(dnorm(x,mean(y1),sd(y1)),col="lightslateblue",type="l", lwd=2, add= T)

```


## Pour l'échantillon 2

 

```{r}

df2 <- subset(Data[,2],
              !is.na(Data[,2]))

M2<-M_realisation_(df2,M)

y2<-Median_(M2)

#head(M2) # On   affiche les 6 premières lignes de notre matrice
#head(M1$X1)# Notre première colonne colonne simulée.
DF<-rbind(M2,y2) # sous chaque colonne trouvé, on met en dessous sa mediane correspondante.

#head(DF)
Me2<- Estimation_(y2) # Estimation de la mediane 
colnames(Me2)<- "Ceo2.4"
rownames(Me2)<-c("M",
                 "Ecart_type",
                 " born_inf", 
                 " born_sup")
Me2<-data.frame(Me2)
Me2
#head(M2)
```
L'estimation de la médiane est 16.15 nm et l'écart type vaut 0.25 nm

## L'histrogramme de notre simulation réalisée est la suivante

```{r}
hist(y2,
     probability = T,
     breaks = 35,
     col= ' gray ',
     xlab = 'médiane (nm)', 
     main = "Ceo2.4")

abline( v=16.15 , col= "red")
abline( v=15.76 , col= "blue")
abline( v= 16.54 , col= "blue")

legend("topleft", legend = c("y_inf", "Estimation", "y_sup"), fill = c("blue", "red", "blue")) 

```

## Pour l'échantillon 3

```{r}
df3 <- subset(Data[,3], 
              !is.na(Data[,3]))

M3<-M_realisation_(df3,M)

y3<-Median_(M3)

#head(M3) # On   affiche les 6 premières lignes de notre matrice
#head(M3$X1)# Notre première colonne colonne simulée.
DF<-rbind(M3,y3) # sous chaque colonne trouvé, on met en dessous sa mediane correspondante.

#head(DF)

#☻Estimation_(y3) 
Me3<- Estimation_(y3) # Estimation de la mediane 
colnames(Me3)<- "R711_PLL"
rownames(Me3)<-c("M",
                 "Ecart_type",
                 " born_inf",
                 " born_sup")
Me3<-data.frame(Me3)
Me3
#head(M3)
```

## L'histrogramme de notre simulation réalisée est la suivante

```{r}

hist(y3,
     probability = T,
     breaks = 35,
     col= ' gray ',
     xlab = 'médiane (nm)', 
     main = "R711_PLL")

abline( v= 18.30, col= "red")
abline( v= 17.71, col= "blue")
abline( v= 18.89 , col= "blue")
legend("topleft", legend = c("y_inf", "Estimation", "y_sup"), fill = c("blue", "red", "blue")) 


```

L'estimation de la médiane est 18.27 nm et l'écart type vaut 0.49 nm


## Pour l'échantillon 4

```{r}

df4 <- subset(Data[,4], 
              !is.na(Data[,4]))

M4<-M_realisation_(df4,M)

y4<-Median_(M4)

#head(M4) # On   affiche les 6 premières lignes de notre matrice
#head(M4$X1)# Notre première colonne colonne simulée.
DF<-rbind(M4,y4) # sous chaque colonne trouvé, on met en dessous sa mediane correspondante.

#head(DF)
Me4<- Estimation_(y4) # Estimation de la mediane 
colnames(Me4)<- "Tio2"
rownames(Me4)<-c("M",
                 "Ecart_type",
                 " born_inf",
                 " born_sup")
Me4<-data.frame(Me4)
Me4
#head(M4)

```
L'estimation de la médiane est 21.08 nm et l'écart type vaut 0.26 nm

## L'histrogramme de notre simulation réalisée est la suivante

```{r}

hist(y4,
     probability = T,
     breaks = 35,
     col= ' gray ',
     xlab = 'médiane (nm)', 
     main = "Tio2")

abline( v= 21.09 , col= "red")
abline( v=20.67 , col= "blue")
abline( v= 21.50  , col= "blue")
legend("topleft", legend = c("y_inf", "Estimation", "y_sup"), fill = c("blue", "red", "blue")) 


```



## Resumé

```{r}
recap1<-cbind(Me1,Me2,Me3,Me4)
recap1

```


#                                          Data_juin_2017

```{r}
df_juin <- read.csv("Data_Juin_2017.csv", head = TRUE, sep = ";")
head(df_juin)

```








### Echantillon 1 ( EVA)

```{r}
df1 <- subset(df_juin[,1],
              !is.na(df_juin[,1]))

M1<-M_realisation_(df1,M)

y1<-Median_(M1)

#head(M1) # On   affiche les 6 premières lignes de notre matrice
#head(M1$X1)# Notre première colonne colonne simulée.

DF<-rbind(M1,y1) # sous chaque colonne trouvé, on met en dessous sa mediane correspondante. 
#head(DF)
Me1<- Estimation_(y1) # Estimation de la mediane 
colnames(Me1)<- "EVA"
rownames(Me1)<-c("M",
                 "Ecart_type",
                 " born_inf", 
                 " born_sup")
Me1<-data.frame(Me1)
Me1

```


```{r}
par (mfrow= c(2,3))
hist(y1, 
     probability = T,
     breaks = 30,
     col= ' gray ',
     xlab = '', 
     main = " histogramme de M simulation (EVA)")
curve(dnorm(x,mean(y1),
                   sd(y1)), 
                   col="lightslateblue",
                   type="l", 
                   lwd=2, 
                   add= T)



```

### Echantillon 2 (ACM9080)



```{r}
df2 <- subset(df_juin[,2],
              !is.na(df_juin[,2]))

M2<-M_realisation_(df2,M)

y2<-Median_(M2)

#head(M1) # On   affiche les 6 premières lignes de notre matrice
#head(M1$X1)# Notre première colonne colonne simulée.

DF<-rbind(M2,y2) # sous chaque colonne trouvé, on met en dessous sa mediane correspondante. 
#head(DF)
Me2<- Estimation_(y2) # Estimation de la mediane 
colnames(Me2)<- "ACM9080"
rownames(Me2)<-c("M",
                 "Ecart_type",
                 " born_inf", 
                 " born_sup")
Me2<-data.frame(Me2)
Me2

```


```{r}

hist(y2, 
     probability = T,
     breaks = 35,
     col= ' gray ',
     xlab = '', 
     main = " histogramme de M simulation (ACM9080)")
curve(dnorm(x,mean(y2),
                   sd(y2)), 
                   col="lightslateblue",
                   type="l", 
                   lwd=2, 
                   add= T)
```


### Echantillon 3 (ACM9060)

```{r}

df3 <- subset(df_juin[,3],
              !is.na(df_juin[,3]))

M3<-M_realisation_(df3,M)

y3<-Median_(M3)

#head(M1) # On   affiche les 6 premières lignes de notre matrice
#head(M1$X1)# Notre première colonne colonne simulée.

DF<-rbind(M3,y3) # sous chaque colonne trouvé, on met en dessous sa mediane correspondante. 
#head(DF)
Me3<- Estimation_(y3) # Estimation de la mediane 
colnames(Me3)<- "ACM9060"
rownames(Me3)<-c("M",
                 "Ecart_type",
                 " born_inf", 
                 " born_sup")
Me3<-data.frame(Me3)
Me3
```


```{r}
hist(y3, 
     probability = T,
     breaks = 30,
     col= ' gray ',
     xlab = '', 
     main = " histogramme de M simulation (ACM9060)")
curve(dnorm(x,mean(y3),
                   sd(y3)), 
                   col="lightslateblue",
                   type="l", 
                   lwd=2, 
                   add= T)

```

### Echanillon 4 (R711) 

```{r}

df4 <- subset(df_juin[,4],
              !is.na(df_juin[,4]))

M4<-M_realisation_(df4,M)

y4<-Median_(M4)

#head(M1) # On   affiche les 6 premières lignes de notre matrice
#head(M1$X1)# Notre première colonne colonne simulée.

DF<-rbind(M4,y4) # sous chaque colonne trouvé, on met en dessous sa mediane correspondante. 
#head(DF)
Me4<- Estimation_(y4) # Estimation de la mediane 
colnames(Me4)<- "R711"
rownames(Me4)<-c("M",
                 "Ecart_type",
                 " born_inf", 
                 " born_sup")
Me4<-data.frame(Me4)
Me4
```


```{r}
hist(y4, 
     probability = T,
     breaks = 30,
     col= ' gray ',
     xlab = '', 
     main = " histogramme de M simulation (R711)")

curve(dnorm(x,mean(y4),
                   sd(y4)), 
                   col="lightslateblue",
                   type="l", 
                   lwd=2, 
                   add= T)


```


### Echanillon 5 (AluC)

```{r}

df5 <- subset(df_juin[,5],
              !is.na(df_juin[,5]))

M5<-M_realisation_(df5,M)

y5<-Median_(M5)

#head(M1) # On   affiche les 6 premières lignes de notre matrice
#head(M1$X1)# Notre première colonne colonne simulée.

DF<-rbind(M5,y5) # sous chaque colonne trouvé, on met en dessous sa mediane correspondante. 
#head(DF)
Me5<- Estimation_(y5) # Estimation de la mediane 
colnames(Me5)<- "ALUC"
rownames(Me5)<-c("M",
                 "Ecart_type",
                 " born_inf", 
                 "born_sup")
Me5<-data.frame(Me5)
Me5

```


```{r}

hist(y5, 
     probability = T,
     breaks = 30,
     col= ' gray ',
     xlab = '', 
     main = " histogramme de M simulation (A200)")

curve(dnorm(x,mean(y5),
                   sd(y5)), 
                   col="lightslateblue",
                   type="l", 
                   lwd=2, 
                   add= T)

```


### Echanillon 6 (A200)

```{r}
df6 <- subset(df_juin[,6],
              !is.na(df_juin[,6]))

M6<-M_realisation_(df6,M)

y6<-Median_(M6)

#head(M1) # On   affiche les 6 premières lignes de notre matrice
#head(M1$X1)# Notre première colonne colonne simulée.

DF<-rbind(M6,y6) # sous chaque colonne trouvé, on met en dessous sa mediane correspondante. 
#head(DF)
Me6<- Estimation_(y6) # Estimation de la mediane 
colnames(Me6)<- "A200"
rownames(Me6)<-c("M",
                 "Ecart_type",
                 " born_inf", 
                 " born_sup")
Me6<-data.frame(Me6)
Me6

```


```{r}
hist(y6, 
     probability = T,
     breaks = 35,
     col= ' gray ',
     xlab = '', 
     main = " histogramme de M simulation (A200)")
curve(dnorm(x,mean(y6),
                   sd(y6)), 
                   col="lightslateblue",
                   type="l", 
                   lwd=2, 
                   add= T)


```

```{r}
recap2<-cbind(Me1,Me2,Me3,Me4,Me5,Me6)
recap2

```


##                             Data_TiO2NP_09031



```{r}
library(xlsx)
df_Tio2<- read.xlsx( "Data_TiO2NP_JN_090318.xlsx", head= TRUE, sheetIndex=1)
head(df_Tio2)


```


```{r}

df1 <- subset(df_Tio2[,1],
              !is.na(df_Tio2[,1]))

M1<-M_realisation_(df1,M)

y1<-Median_(M1)


DF<-rbind(M1,y1) # sous chaque colonne trouvé, on met en dessous sa mediane correspondante. 
Me1<- Estimation_(y1) # Estimation de la mediane 
colnames(Me1)<- "X27.CG4x400b"
rownames(Me1)<-c("M",
                 "Ecart_type",
                 " born_inf", 
                 " born_sup")
Me1<-data.frame(Me1)
Me1


```


```{r}

hist(y1, 
     probability = T,
     breaks = 30,
     col= ' gray ',
     xlab = '', 
     main = " histogramme de M simulation (X27.CG4x400b)")
curve(dnorm(x,mean(y1),
                   sd(y1)), 
                   col="lightslateblue",
                   type="l", 
                   lwd=2, 
                   add= T)
```


```{r}
df2 <- subset(df_Tio2[,2],
              !is.na(df_Tio2[,2]))

M2<-M_realisation_(df1,M)

y2<-Median_(M2)
DF<-rbind(M2,y2) # sous chaque colonne trouvé, on met en dessous sa mediane correspondante. 
Me2<- Estimation_(y2) # Estimation de la mediane 
colnames(Me2)<- "X31.CG4x400c"
rownames(Me2)<-c("M",
                 "Ecart_type",
                 " born_inf", 
                 " born_sup")
Me2<-data.frame(Me2)
Me2
```


```{r}
hist(y2, 
     probability = T,
     breaks = 30,
     col= ' gray ',
     xlab = '', 
     main = " histogramme de M simulation (X31.CG4x400c)")
curve(dnorm(x,mean(y2),
                   sd(y2)), 
                   col="lightslateblue",
                   type="l", 
                   lwd=2, 
                   add= T)
```


```{r}

df3 <- subset(df_Tio2[,3],
              !is.na(df_Tio2[,3]))

M3<-M_realisation_(df3,M)

y3<-Median_(M3)

DF<-rbind(M3,y3) # sous chaque colonne trouvé, on met en dessous sa mediane correspondante. 
Me3<- Estimation_(y3) # Estimation de la mediane 
colnames(Me3)<- "X37.CG4x300"
rownames(Me3)<-c("M",
                 "Ecart_type",
                 " born_inf", 
                 " born_sup")
Me3<-data.frame(Me3)
Me3
```


```{r}
hist(y3, 
     probability = T,
     breaks = 30,
     col= ' gray ',
     xlab = '', 
     main = " histogramme de M simulation (X37.CG4x300)")
curve(dnorm(x,mean(y3),
                   sd(y3)), 
                   col="lightslateblue",
                   type="l", 
                   lwd=2, 
                   add= T)

```


```{r}
df4 <- subset(df_Tio2[,4],
              !is.na(df_Tio2[,4]))

M4<-M_realisation_(df4,M)

y4<-Median_(M4)

#head(M1) # On   affiche les 6 premières lignes de notre matrice
#head(M1$X1)# Notre première colonne colonne simulée.

DF<-rbind(M4,y4) # sous chaque colonne trouvé, on met en dessous sa mediane correspondante. 
#head(DF)
Me4<- Estimation_(y4) # Estimation de la mediane 
colnames(Me4)<- "X39.CG4x200"
rownames(Me4)<-c("M",
                 "Ecart_type",
                 " born_inf", 
                 " born_sup")
Me4<-data.frame(Me4)
Me4
```


```{r}

hist(y4, 
     probability = T,
     breaks = 30,
     col= ' gray ',
     xlab = '', 
     main = " histogramme de M simulation (X39.CG4x200)")
curve(dnorm(x,mean(y4),
                   sd(y4)), 
                   col="lightslateblue",
                   type="l", 
                   lwd=2, 
                   add= T)
```


```{r}

df5 <- subset(df_Tio2[,5],
              !is.na(df_Tio2[,5]))

M5<-M_realisation_(df5,M)

y5<-Median_(M5)

#head(M1) # On   affiche les 6 premières lignes de notre matrice
#head(M1$X1)# Notre première colonne colonne simulée.

DF<-rbind(M5,y5) # sous chaque colonne trouvé, on met en dessous sa mediane correspondante. 
#head(DF)
Me5<- Estimation_(y5) # Estimation de la mediane 
colnames(Me5)<- "X56.CG6x400"
rownames(Me5)<-c("M",
                 "Ecart_type",
                 " born_inf", 
                 " born_sup")
Me5<-data.frame(Me5)
Me5
```


```{r}
hist(y5, 
     probability = T,
     breaks = 30,
     col= ' gray ',
     xlab = '', 
     main = " histogramme de M simulation (X56.CG6x400)")
curve(dnorm(x,mean(y5),
                   sd(y5)), 
                   col="lightslateblue",
                   type="l", 
                   lwd=2, 
                   add= T)
```


```{r}

df6 <- subset(df_Tio2[,6],
              !is.na(df_Tio2[,6]))

M6<-M_realisation_(df6,M)

y6<-Median_(M6)
DF<-rbind(M6,y6) # sous chaque colonne trouvé, on met en dessous sa mediane correspondante. 
Me6<- Estimation_(y6) # Estimation de la mediane 
colnames(Me6)<- "X64.CG6x200"
rownames(Me6)<-c("M",
                 "Ecart_type",
                 " born_inf", 
                 " born_sup")
Me6<-data.frame(Me6)
Me6
```


```{r}
hist(y6, 
     probability = T,
     breaks = 30,
     col= ' gray ',
     xlab = '', 
     main = " histogramme de M simulation (X64.CG6x200)")
curve(dnorm(x,mean(y6),
                   sd(y6)), 
                   col="lightslateblue",
                   type="l", 
                   lwd=2, 
                   add= T)

```


```{r}

df7 <- subset(df_Tio2[,7],
              !is.na(df_Tio2[,7]))
M7<-M_realisation_(df7,M)
y7<-Median_(M7)
DF<-rbind(M7,y7) # sous chaque colonne trouvé, on met en dessous sa mediane correspondante. 
Me7<- Estimation_(y7) # Estimation de la mediane 
colnames(Me7)<- "X23.A8_1x90x80"
rownames(Me7)<-c("M",
                 "Ecart_type",
                 " born_inf", 
                 " born_sup")
Me7<-data.frame(Me7)
Me7
```


```{r}

hist(y7, 
     probability = T,
     breaks = 30,
     col= ' gray ',
     xlab = '', 
     main = " histogramme de M simulation (X23.A8_1x90x80)")
curve(dnorm(x,mean(y7),
                   sd(y7)), 
                   col="lightslateblue",
                   type="l", 
                   lwd=2, 
                   add= T)

```


```{r}
df8 <- subset(df_Tio2[,8],
              !is.na(df_Tio2[,8]))

M8<-M_realisation_(df8,M)

y8<-Median_(M8)

DF<-rbind(M8,y8) # sous chaque colonne trouvé, on met en dessous sa mediane correspondante. 
Me8<- Estimation_(y8) # Estimation de la mediane 
colnames(Me8)<- "X27.A8.2x50x50"
rownames(Me8)<-c("M",
                 "Ecart_type",
                 " born_inf", 
                 " born_sup")
Me8<-data.frame(Me8)
Me8
```


```{r}
hist(y8, 
     probability = T,
     breaks = 30,
     col= ' gray ',
     xlab = '', 
     main = " histogramme de M simulation (X27.A8.2x50x50)")
curve(dnorm(x,mean(y8),
                   sd(y8)), 
                   col="lightslateblue",
                   type="l", 
                   lwd=2, 
                   add= T)
```


```{r}
df9 <- subset(df_Tio2[,9],
              !is.na(df_Tio2[,9]))

M9<-M_realisation_(df9,M)

y9<-Median_(M9)

#head(M1) # On   affiche les 6 premières lignes de notre matrice
#head(M1$X1)# Notre première colonne colonne simulée.

DF<-rbind(M9,y9) # sous chaque colonne trouvé, on met en dessous sa mediane correspondante. 
#head(DF)
Me9<- Estimation_(y9) # Estimation de la mediane 
colnames(Me9)<- "X46.CG7x1500x30"
rownames(Me9)<-c("M",
                 "Ecart_type",
                 " born_inf", 
                 " born_sup")
Me9<-data.frame(Me9)
Me9
```


```{r}
hist(y9, 
     probability = T,
     breaks = 30,
     col= ' gray ',
     xlab = '', 
     main = " histogramme de M simulation (X46.CG7x1500x30)")
curve(dnorm(x,mean(y9),
                   sd(y9)), 
                   col="lightslateblue",
                   type="l", 
                   lwd=2, 
                   add= T)
```


```{r}
df10 <- subset(df_Tio2[,10],
              !is.na(df_Tio2[,10]))

M10<-M_realisation_(df10,M)

y10<-Median_(M10)

#head(M1) # On   affiche les 6 premières lignes de notre matrice
#head(M1$X1)# Notre première colonne colonne simulée.

DF<-rbind(M10,y10) # sous chaque colonne trouvé, on met en dessous sa mediane correspondante. 
#head(DF)
Me10<- Estimation_(y10) # Estimation de la mediane 
colnames(Me10)<- "X50.MM4x1300x200"
rownames(Me10)<-c("M",
                 "Ecart_type",
                 " born_inf", 
                 " born_sup")
Me10<-data.frame(Me10)
Me10
```


```{r}
hist(y10, 
     probability = T,
     breaks = 30,
     col= ' gray ',
     xlab = '', 
     main = " histogramme de M simulation (X50.MM4x1300x200)")
curve(dnorm(x,mean(y10),
                   sd(y10)), 
                   col="lightslateblue",
                   type="l", 
                   lwd=2, 
                   add= T)

```


```{r}
df11 <- subset(df_Tio2[,11],
              !is.na(df_Tio2[,11]))

M11<-M_realisation_(df11,M)

y11<-Median_(M11)

#head(M1) # On   affiche les 6 premières lignes de notre matrice
#head(M1$X1)# Notre première colonne colonne simulée.

DF<-rbind(M11,y11) # sous chaque colonne trouvé, on met en dessous sa mediane correspondante. 
#head(DF)
Me11<- Estimation_(y11) # Estimation de la mediane 
colnames(Me11)<- "X53.MM5x1000x300"
rownames(Me11)<-c("M",
                 "Ecart_type",
                 " born_inf", 
                 " born_sup")
Me11<-data.frame(Me11)
Me11
```


```{r}

hist(y11, 
     probability = T,
     breaks = 35,
     col= ' gray ',
     xlab = '', 
     main = " histogramme de M simulation (X53.MM5x1000x300)")
curve(dnorm(x,mean(y11),
                   sd(y11)), 
                   col="lightslateblue",
                   type="l", 
                   lwd=2, 
                   add= T)
```


```{r}
recap3<-cbind(Me1,Me2,Me3,Me4,Me5,Me6,Me7,Me8,Me9,Me10,Me11)
recap3

```

##                                DataCC2

```{r}

df_cc2<- read.csv( "dataCC2.csv", head= TRUE, sep =';')
head(df_cc2)
```


```{r}
df1 <- subset(df_cc2[,1],
              !is.na(df_cc2[,1]))

M1<-M_realisation_(df1,M)

y1<-Median_(M1)

#head(M1) # On   affiche les 6 premières lignes de notre matrice
#head(M1$X1)# Notre première colonne colonne simulée.

DF<-rbind(M1,y1) # sous chaque colonne trouvé, on met en dessous sa mediane correspondante. 
#head(DF)
Me1<- Estimation_(y1) # Estimation de la mediane 
colnames(Me1)<- "A200.PLL"
rownames(Me1)<-c("M",
                 "Ecart_type",
                 " born_inf", 
                 " born_sup")
Me1<-data.frame(Me1)
Me1

```


```{r}
hist(y1, 
     probability = T,
     breaks = 35,
     col= ' gray ',
     xlab = '', 
     main = " histogramme de M simulation (A200.PLL)")
curve(dnorm(x,mean(y1),
                   sd(y1)), 
                   col="lightslateblue",
                   type="l", 
                   lwd=2, 
                   add= T)

```


```{r}
df2 <- subset(df_cc2[,2],
              !is.na(df_cc2[,2]))

M2<-M_realisation_(df2,M)

y2<-Median_(M2)

#head(M2) # On   affiche les 6 premières lignes de notre matrice
#head(M2$X2)# Notre première colonne colonne simulée.

DF<-rbind(M2,y2) # sous chaque colonne trouvé, on met en dessous sa mediane correspondante. 
#head(DF)
Me2<- Estimation_(y2) # Estimation de la mediane 
colnames(Me2)<- "AluC"
rownames(Me2)<-c("M",
                 "Ecart_type",
                 " born_inf", 
                 " born_sup")
Me2<-data.frame(Me2)
Me2
```


```{r}
hist(y2, 
     probability = T,
     breaks = 35,
     col= ' gray ',
     xlab = '', 
     main = " histogramme de M simulation (AluC)")
curve(dnorm(x,mean(y2),
                   sd(y2)), 
                   col="lightslateblue",
                   type="l", 
                   lwd=2, 
                   add= T)
```


```{r}

df3 <- subset(df_cc2[,3],
              !is.na(df_cc2[,3]))

M3<-M_realisation_(df3,M)

y3<-Median_(M3)

#head(M3) # On   affiche les 6 premières lignes de notre matrice
#head(M3$X3)# Notre première colonne colonne simulée.

DF<-rbind(M3,y3) # sous chaque colonne trouvé, on met en dessous sa mediane correspondante. 
#head(DF)
Me3<- Estimation_(y3) # Estimation de la mediane 
colnames(Me3)<- "Bohemite_9060"
rownames(Me3)<-c("M",
                 "Ecart_type",
                 " born_inf", 
                 " born_sup")
Me3<-data.frame(Me3)
Me3
```


```{r}
hist(y3, 
     probability = T,
     breaks = 35,
     col= ' gray ',
     xlab = '', 
     main = " histogramme de M simulation (Bohemite_9060)")
curve(dnorm(x,mean(y3),
                   sd(y3)), 
                   col="lightslateblue",
                   type="l", 
                   lwd=2, 
                   add= T)
```


```{r}

df4 <- subset(df_cc2[,4],
              !is.na(df_cc2[,4]))

M4<-M_realisation_(df4,M)

y4<-Median_(M4)

#head(M4) # On   affiche les 6 premières lignes de notre matrice
#head(M4$X4)# Notre première colonne colonne simulée.

DF<-rbind(M4,y4) # sous chaque colonne trouvé, on met en dessous sa mediane correspondante. 
#head(DF)
Me4<- Estimation_(y4) # Estimation de la mediane 
colnames(Me4)<- "Bohemite_9080"
rownames(Me4)<-c("M",
                 "Ecart_type",
                 " born_inf", 
                 " born_sup")
Me4<-data.frame(Me4)
Me4
```


```{r}
hist(y4, 
     probability = T,
     breaks = 35,
     col= ' gray ',
     xlab = '', 
     main = " histogramme de M simulation (Bohemite_9080)")
curve(dnorm(x,mean(y4),
                   sd(y4)), 
                   col="lightslateblue",
                   type="l", 
                   lwd=2, 
                   add= T)

```


```{r}recap4<-cbind(Me1,Me2,Me3,Me4)
recap4

``` 

##                                   ResultatCEAStat                   

```{r}

df<- read.csv("RésultatsCEAStatt.csv", head= TRUE, sep = ';')
head(df)
```


```{r}
df1 <- subset(df[,1],
              !is.na(df[,1]))

M1<-M_realisation_(df1,M)

y1<-Median_(M1)

#head(M1) # On   affiche les 6 premières lignes de notre matrice
#head(M1$X1)# Notre première colonne colonne simulée.

DF<-rbind(M1,y1) # sous chaque colonne trouvé, on met en dessous sa mediane correspondante. 
#head(DF)
Me1<- Estimation_(y1) # Estimation de la mediane 
colnames(Me1)<- "Ag.2min.CEA"
rownames(Me1)<-c("M",
                 "Ecart_type",
                 " born_inf", 
                 " born_sup")
Me1<-data.frame(Me1)
Me1
e<-quantile(y1,probs = 0.95)

```


   
```{r}

hist(y1, 
     probability = T,
     breaks = 30,
     col= ' gray ',
     xlab = '', 
     main = " histogramme de M simulation (Ag.2min.CEA)")
curve(dnorm(x,mean(y1),
                   sd(y1)), 
                   col="lightslateblue",
                   type="l", 
                   lwd=2, 
                   add= T)
```


```{r}
df2 <- subset(df[,2],
              !is.na(df[,2]))

M2<-M_realisation_(df2,M)

y2<-Median_(M2)

#head(M2) # On   affiche les 6 premières lignes de notre matrice
#head(M2$X2)# Notre première colonne colonne simulée.

DF<-rbind(M2,y2) # sous chaque colonne trouvé, on met en dessous sa mediane correspondante. 
#head(DF)
Me2<- Estimation_(y2) # Estimation de la mediane 
colnames(Me2)<- "Au.BBI.CEA"
rownames(Me2)<-c("M",
                 "Ecart_type",
                 " born_inf", 
                 " born_sup")
Me2<-data.frame(Me2)
Me2
```


```{r}
hist(y2, 
     probability = T,
     breaks = 30,
     col= ' gray ',
     xlab = '', 
     main = " histogramme de M simulation (AU.BBI.CEA)")
curve(dnorm(x,mean(y2),
                   sd(y2)), 
                   col="lightslateblue",
                   type="l", 
                   lwd=2, 
                   add= T)
```


```{r}
df3 <- subset(df[,3],
              !is.na(df[,3]))

M3<-M_realisation_(df3,M)

y3<-Median_(M3)

#head(M3) # On   affiche les 6 premières lignes de notre matrice
#head(M3$X3)# Notre première colonne colonne simulée.

DF<-rbind(M3,y3) # sous chaque colonne trouvé, on met en dessous sa mediane correspondante. 
#head(DF)
Me3<- Estimation_(y3) # Estimation de la mediane 
colnames(Me3)<- "Au.JFH.PH6.CEA"
rownames(Me3)<-c("M",
                 "Ecart_type",
                 " born_inf", 
                 " born_sup")
Me3<-data.frame(Me3)
Me3
```

```{r}
hist(y3, 
     probability = T,
     breaks = 35,
     col= ' gray ',
     xlab = '', 
     main = " histogramme de M simulation (Au.JFH.PH6.CEA)")
curve(dnorm(x,mean(y3),
                   sd(y3)), 
                   col="lightslateblue",
                   type="l", 
                   lwd=2, 
                   add= T)
```


```{r}
df4 <- subset(df[,4],
              !is.na(df[,4]))

M4<-M_realisation_(df4,M)

y4<-Median_(M4)

#head(M4) # On   affiche les 6 premières lignes de notre matrice
#head(M4$X4)# Notre première colonne colonne simulée.

DF<-rbind(M4,y4) # sous chaque colonne trouvé, on met en dessous sa mediane correspondante. 
#head(DF)
Me4<- Estimation_(y4) # Estimation de la mediane 
colnames(Me4)<- "Au.JFH.PH8.CEA"
rownames(Me4)<-c("M",
                 "Ecart_type",
                 " born_inf", 
                 " born_sup")
Me4<-data.frame(Me4)
Me4
```


```{r}
hist(y4, 
     probability = T,
     breaks = 30,
     col= ' gray ',
     xlab = '', 
     main = " histogramme de M simulation (Au.JFH.PH8.CEA)")
curve(dnorm(x,mean(y4),
                   sd(y4)), 
                   col="lightslateblue",
                   type="l", 
                   lwd=2, 
                   add= T)
```


```{r}
df5 <- subset(df[,5],
              !is.na(df[,5]))

M5<-M_realisation_(df5,M)

y5<-Median_(M5)

#head(M5) # On   affiche les 6 premières lignes de notre matrice
#head(M5$X5)# Notre première colonne colonne simulée.

DF<-rbind(M5,y5) # sous chaque colonne trouvé, on met en dessous sa mediane correspondante. 
#head(DF)
Me5<- Estimation_(y5) # Estimation de la mediane 
colnames(Me5)<- "CeO2.4.CEA"
rownames(Me5)<-c("M",
                 "Ecart_type",
                 " born_inf", 
                 " born_sup")
Me5<-data.frame(Me5)
Me5
```


```{r}
hist(y5, 
     probability = T,
     breaks = 30,
     col= ' gray ',
     xlab = '', 
     main = " histogramme de M simulation (CeO2.4.CEA)")
curve(dnorm(x,mean(y5),
                   sd(y5)), 
                   col="lightslateblue",
                   type="l", 
                   lwd=2, 
                   add= T)

```


```{r}
df6 <- subset(df[,6],
              !is.na(df[,6]))

M6<-M_realisation_(df6,M)

y6<-Median_(M6)

#head(M6) # On   affiche les 6 premières lignes de notre matrice
#head(M6$X6)# Notre première colonne colonne simulée.

DF<-rbind(M6,y6) # sous chaque colonne trouvé, on met en dessous sa mediane correspondante. 
#head(DF)
Me6<- Estimation_(y6) # Estimation de la mediane 
colnames(Me6)<- "SiO2.NEXSIL35A.CEA"
rownames(Me6)<-c("M",
                 "Ecart_type",
                 " born_inf", 
                 " born_sup")
Me6<-data.frame(Me6)
Me6
```

```{r}
hist(y6, 
     probability = T,
     breaks = 30,
     col= ' gray ',
     xlab = '', 
     main = " histogramme de M simulation (SiO2.NEXSIL35A.CEA)")
curve(dnorm(x,mean(y6),
                   sd(y6)), 
                   col="lightslateblue",
                   type="l", 
                   lwd=2, 
                   add= T)

```


```{r}
df7 <- subset(df[,7],
              !is.na(df[,7]))

M7<-M_realisation_(df7,M)

y7<-Median_(M7)

#head(M7) # On   affiche les 6 premières lignes de notre matrice
#head(M7$X7)# Notre première colonne colonne simulée.

DF<-rbind(M7,y7) # sous chaque colonne trouvé, on met en dessous sa mediane correspondante. 
#head(DF)
Me7<- Estimation_(y7) # Estimation de la mediane 
colnames(Me7)<- "TiO2.JFH.CEA"
rownames(Me7)<-c("M",
                 "Ecart_type",
                 " born_inf", 
                 " born_sup")
Me7<-data.frame(Me7)
Me7
```


```{r}
hist(y7, 
     probability = T,
     breaks = 30,
     col= ' gray ',
     xlab = '', 
     main = " histogramme de M simulation (TiO2.JFH.CEA)")
curve(dnorm(x,mean(y7),
                   sd(y7)), 
                   col="lightslateblue",
                   type="l", 
                   lwd=2, 
                   add= T)
```

```{r}
df8 <- subset(df[,8],
              !is.na(df[,8]))

M8<-M_realisation_(df8,M)

y8<-Median_(M8)

#head(M8) # On   affiche les 6 premières lignes de notre matrice
#head(M8$X8)# Notre première colonne colonne simulée.

DF<-rbind(M8,y8) # sous chaque colonne trouvé, on met en dessous sa mediane correspondante. 
#head(DF)
Me8<- Estimation_(y8) # Estimation de la mediane 
colnames(Me8)<- "ZnO.2.CEA"
rownames(Me8)<-c("M",
                 "Ecart_type",
                 " born_inf", 
                 " born_sup")
Me8<-data.frame(Me8)
Me8
```


```{r}
hist(y8, 
     probability = T,
     breaks = 30,
     col= ' gray ',
     xlab = '', 
     main = " histogramme de M simulation (ZnO.2.CEA)")
curve(dnorm(x,mean(y8),
                   sd(y8)), 
                   col="lightslateblue",
                   type="l", 
                   lwd=2, 
                   add= T)
```



```{r}
df9 <- subset(df[,9],
              !is.na(df[,9]))

M9<-M_realisation_(df9,M)

y9<-Median_(M9)

#head(M9) # On   affiche les 6 premières lignes de notre matrice
#head(M9$X9)# Notre première colonne colonne simulée.

DF<-rbind(M9,y9) # sous chaque colonne trouvé, on met en dessous sa mediane correspondante. 
#head(DF)
Me9<- Estimation_(y9) # Estimation de la mediane 
colnames(Me9)<- "B3.CEA"
rownames(Me9)<-c("M",
                 "Ecart_type",
                 " born_inf", 
                 " born_sup")
Me9<-data.frame(Me9)
Me9
```


```{r}
hist(y9, 
     probability = T,
     breaks = 30,
     col= ' gray ',
     xlab = '', 
     main = " histogramme de M simulation (B3.CEA)")
curve(dnorm(x,mean(y9),
                   sd(y9)), 
                   col="lightslateblue",
                   type="l", 
                   lwd=2, 
                   add= T)
```


```{r}
df10 <- subset(df[,10],
              !is.na(df[,10]))

M10<-M_realisation_(df10,M)

y10<-Median_(M10)

#head(M10) # On   affiche les 6 premières lignes de notre matrice
#head(M10$X10)# Notre première colonne colonne simulée.

DF<-rbind(M10,y10) # sous chaque colonne trouvé, on met en dessous sa mediane correspondante. 
#head(DF)
Me10<- Estimation_(y10) # Estimation de la mediane 
colnames(Me10)<- "B10.CEA"
rownames(Me10)<-c("M",
                 "Ecart_type",
                 " born_inf", 
                 " born_sup")
Me10<-data.frame(Me10)
Me10

```


```{r}
hist(y10, 
     probability = T,
     breaks = 30,
     col= ' gray ',
     xlab = '', 
     main = " histogramme de M simulation (B10.CEA)")
curve(dnorm(x,mean(y10),
                   sd(y10)), 
                   col="lightslateblue",
                   type="l", 
                   lwd=2, 
                   add= T)
```


```{r}
df11 <- subset(df[,11],
              !is.na(df[,11]))

M11<-M_realisation_(df11,M)

y11<-Median_(M11)

#head(M10) # On   affiche les 6 premières lignes de notre matrice
#head(M10$X10)# Notre première colonne colonne simulée.

DF<-rbind(M11,y11) # sous chaque colonne trouvé, on met en dessous sa mediane correspondante. 
#head(DF)
Me11<- Estimation_(y11) # Estimation de la mediane 
colnames(Me11)<- "Hematite.CEA"
rownames(Me11)<-c("M",
                 "Ecart_type",
                 " born_inf", 
                 " born_sup")
Me11<-data.frame(Me11)
Me11

```


```{r}
hist(y11, 
     probability = T,
     breaks = 30,
     col= ' gray ',
     xlab = '', 
     main = " histogramme de M simulation (Hematite.CEA)")
curve(dnorm(x,mean(y11),
                   sd(y11)), 
                   col="lightslateblue",
                   type="l", 
                   lwd=2, 
                   add= T)
```


```{r}
df12 <- subset(df[,12],
              !is.na(df[,12]))

M12<-M_realisation_(df12,M)

y12<-Median_(M12)

#head(M12) # On   affiche les 6 premières lignes de notre matrice
#head(M12$X12)# Notre première colonne colonne simulée.

DF<-rbind(M12,y12) # sous chaque colonne trouvé, on met en dessous sa mediane correspondante. 
#head(DF)
Me12<- Estimation_(y12) # Estimation de la mediane 
colnames(Me12)<- "B6.CEA"
rownames(Me12)<-c("M",
                 "Ecart_type",
                 " born_inf", 
                 " born_sup")
Me12<-data.frame(Me12)
Me12
```


```{r}
hist(y12, 
     probability = T,
     breaks = 30,
     col= ' gray ',
     xlab = '', 
     main = " histogramme de M simulation (B6.CEA)")
curve(dnorm(x,mean(y12),
                   sd(y12)), 
                   col="lightslateblue",
                   type="l", 
                   lwd=2, 
                   add= T)
```


```{r}
df13 <- subset(df[,13],
              !is.na(df[,13]))

M13<-M_realisation_(df13,M)

y13<-Median_(M13)

#head(M13) # On   affiche les 6 premières lignes de notre matrice
#head(M13$X13)# Notre première colonne colonne simulée.

DF<-rbind(M13,y13) # sous chaque colonne trouvé, on met en dessous sa mediane correspondante. 
#head(DF)
Me13<- Estimation_(y13) # Estimation de la mediane 
colnames(Me13)<- "B9.CEA"
rownames(Me13)<-c("M",
                 "Ecart_type",
                 " born_inf", 
                 " born_sup")
Me13<-data.frame(Me13)
Me13
```


```{r}
hist(y13, 
     probability = T,
     breaks = 30,
     col= ' gray ',
     xlab = '', 
     main = " histogramme de M simulation (B9.CEA)")
curve(dnorm(x,mean(y13),
                   sd(y13)), 
                   col="lightslateblue",
                   type="l", 
                   lwd=2, 
                   add= T)
```


```{r}
df14 <- subset(df[,14],
              !is.na(df[,14]))

M14<-M_realisation_(df14,M)

y14<-Median_(M14)

#head(M14) # On   affiche les 6 premières lignes de notre matrice
#head(M14$X14)# Notre première colonne colonne simulée.

DF<-rbind(M14,y14) # sous chaque colonne trouvé, on met en dessous sa mediane correspondante. 
#head(DF)
Me14<- Estimation_(y14) # Estimation de la mediane 
colnames(Me14)<- "Ni.OH.2.CEA"
rownames(Me14)<-c("M",
                 "Ecart_type",
                 " born_inf", 
                 " born_sup")
Me14<-data.frame(Me14)
Me14
```


```{r}
hist(y14, 
     probability = T,
     breaks = 30,
     col= ' gray ',
     xlab = '', 
     main = " histogramme de M simulation (Ni.OH.2.CEA)")
curve(dnorm(x,mean(y14),
                   sd(y14)), 
                   col="lightslateblue",
                   type="l", 
                   lwd=2, 
                   add= T)
```


```{r}
```


```{r}

```


```{r}

recap5<-cbind(Me1,Me2,Me3,Me4,Me5,Me6,Me7,Me8,Me9,Me10,Me11,Me12,Me13,Me14)
recap5

```


```{r}
```


```{r}
```


```{r}
```

### APPLICATIOPN DE LA NORME:


# Tableau 1
Valeurs exactes de k pouir des éffectifs d'échantillon de 5 à 100: Unilatéral

```{r}
n<-5:100
# Niveau de confiance

k_80<-c(2,2,2,3,3,4,4,5,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,14,14,15,15,15,16,16,17,17,18,18,19,19,20,20,21,21,22,22,22,23,23,24,24,25,25,25,26,26,27,27,28,28,29,29,30,30,31,31,31,32,32,33,33,34,34,35,35,36,36,37,37,38,38,39,39,40,40,41,41,41,42,42,43,43,44,44,45,45,46)

k_90<- c(1,1,2,2,3,3,3,4,4,5,5,5,6,6,7,7,8,8,8,9,9,10,10,11,11,11,12,12,13,13,14,14,15,15,16,16,16,17,17,18,18,19,19,20,20,20,21,21,22,22,23,23,24,24,25,25,25,26,26,27,27,28,28,29,29,30,30,31,31,31,32,32,33,33,34,34,35,35,36,36,37,37,38,38,38,39,39,40,40,41,41,42,42,43,43,44)

k_95<-c(1,1,1,2,2,2,3,3,4,4,4,5,5,6,6,6,7,7,8,8,8,9,9,10,10,11,11,11,12,12,13,13,14,14,14,15,15,16,16,17,17,17,18,18,19,19,20,20,21,21,21,22,22,23,23,24,24,25,25,25,26,26,27,27,28,28,29,29,29,30,30,31,31,32,32,33,33,34,34,34,35,35,36,36,37,37,38,38,39,39,39,40,40,41,41,42)

k_98<-c(0,1,1,1,2,2,2,3,3,3,4,4,4,5,5,5,6,6,7,7,7,8,8,9,9,9,10,10,11,11,11,12,12,13,13,14,14,14,15,15,16,16,17,17,17,18,18,19,19,19,20,20,21,21,22,22,23,23,23,24,24,25,25,26,26,26,27,27,28,28,29,29,30,30,30,31,31,32,32,33,33,34,34,34,35,35,36,36,37,37,38,38,38,39,39,40)

k_99<- c(0,0,1,1,1,1,2,2,2,3,3,3,4,4,5,5,5,6,6,6,7,7,8,8,8,9,9,9,10,10,11,11,11,12,12,13,13,14,14,14,15,15,16,16,16,17,17,18,18,19,19,19,20,20,21,21,21,22,22,23,23,24,24,24,25,25,26,26,27,27,27,28,28,29,29,30,30,31,31,31,32,32,33,33,34,34,34,35,35,36,36,37,37,38,38,38)

k_99.5<- c(0,0,0,1,1,1,1,2,2,2,3,3,3,4,4,4,5,5,5,6,6,7,7,7,8,8,8,9,9,10,10,10,11,11,12,12,12,13,13,14,14,14,15,15,16,16,16,17,17,18,18,18,19,19,20,20,21,21,21,22,22,23,23,23,24,24,25,25,26,26,26,27,27,28,28,29,29,29,30,30,31,31,32,32,32,33,33,34,34,35,35,35,36,36,37,37)

k_99.8 <- c(0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,4,4,4,5,5,5,6,6,7,7,7,8,8,8,9,9,10,10,10,11,11,11,12,12,13,13,13,14,14,15,15,15,16,16,17,17,17,18,18,19,19,19,20,20,21,21,21,22,22,23,23,23,24,24,25,25,26,26,26,27,27,28,28,28,29,29,30,30,31,31,31,32,32,33,33,34,34,34,35,35,36)


k_99.9<- c(0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,4,4,4,5,5,5,6,6,6,7,7,7,8,8,9,9,9,10,10,10,11,11,12,12,12,13,13,13,14,14,15,15,15,16,16,17,17,17,18,18,19,19,19,20,20,21,21,21,22,22,23,23,23,24,24,25,25,25,26,26,27,27,28,28,28,29,29,30,30,30,31,31,32,32,33,33,33,34,34,35)

Tableau1<-cbind(n,k_80,k_90,k_95,k_98,k_99,k_99.5,k_99.8,k_99.9)

Tableau1<-data.frame(Tableau1)
head(Tableau1)
```

# Tableau 2
Valeurs exactes de k pouir des éffectifs d'échantillon de 5 à 100: bilatéral


```{r}

# Effectif d'échantillon n:

n<-5:100
# Niveau de confiance

k_p_80<-c(1,1,2,2,3,3,3,4,4,5,5,5,6,6,7,7,8,8,8,9,9,10,10,11,11,11,12,12,13,13,14,14,15,15,16,16,16,17,17,18,18,19,19,20,20,20,21,21,22,22,23,23,24,24,25,25,25,26,26,27,27,28,28,29,29,30,30,31,31,31,32,32,33,33,34,34,35,35,36,36,37,37,38,38,38,39,39,40,40,41,41,42,42,43,43,44)

k_p_90<- c(1,1,1,2,2,2,3,3,4,4,4,5,5,6,6,6,7,7,8,8,8,9,9,10,10,11,11,11,12,12,13,13,14,14,14,15,15,16,16,17,17,17,18,18,19,19,20,20,21,21,21,22,22,23,23,24,24,25,25,25,26,26,27,27,28,28,29,29,29,30,30,31,31,32,32,33,33,34,34,34,35,35,36,36,37,37,38,38,39,39,39,40,40,41,41,42)

k_p_95<-c(0,1,1,1,2,2,2,3,3,3,4,4,5,5,5,6,6,6,7,7,8,8,8,9,9,10,10,10,11,11,12,12,13,13,13,14,14,15,15,16,16,16,17,17,18,18,19,19,19,20,20,21,21,22,22,22,23,23,24,24,25,25,26,26,26,27,27,28,28,29,29,29,30,30,31,31,32,32,33,33,33,34,34,35,35,36,36,37,37,38,38,38,39,39,40,40)



k_p_98<- c(0,0,1,1,1,1,2,2,2,3,3,3,4,4,5,5,5,6,6,6,7,7,8,8,8,9,9,9,10,10,11,11,11,12,12,13,13,14,14,14,15,15,16,16,16,17,17,18,18,19,19,19,20,20,21,21,21,22,22,23,23,24,24,24,25,25,26,26,27,27,27,28,28,29,29,30,30,31,31,31,32,32,33,33,34,34,34,35,35,36,36,37,37,38,38,38)



k_p_99<- c(0,0,0,1,1,1,1,2,2,2,3,3,3,4,4,4,5,5,5,6,6,7,7,7,8,8,8,9,9,10,10,10,11,11,12,12,12,13,13,14,14,14,15,15,16,16,16,17,17,18,18,18,19,19,20,20,21,21,21,22,22,23,23,23,24,24,25,25,26,26,26,27,27,28,28,29,29,29,30,30,31,31,32,32,32,33,33,34,34,35,35,35,36,36,37,37)



k_p_99.5 <- c(0,0,0,0,1,1,1,1,2,2,2,3,3,3,4,4,4,5,5,5,6,6,6,7,7,7,8,8,9,9,9,10,10,10,11,11,12,12,12,13,13,14,14,14,15,15,16,16,16,17,17,18,18,18,19,19,20,20,20,21,21,22,22,23,23,23,24,24,25,25,25,26,26,27,27,28,28,28,29,29,30,30,30,31,31,32,32,33,33,33,34,34,35,35,36,36)


k_p_99.8<- c(0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,4,4,4,5,5,5,6,6,6,7,7,7,8,8,9,9,9,10,10,10,11,11,12,12,12,13,13,13,14,14,15,15,15,16,16,17,17,17,18,18,19,19,19,20,20,21,21,21,22,22,23,23,23,24,24,25,25,25,26,26,27,27,28,28,28,29,29,30,30,30,31,31,32,32,33,33,33,34,34,35)


k_p_99.9<- c(0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,4,4,4,5,5,5,6,6,6,7,7,7,8,8,8,9,9,9,10,10,11,11,11,12,12,12,13,13,14,14,14,15,15,15,16,16,17,17,17,18,18,19,19,19,20,20,21,21,21,22,22,23,23,23,24,24,25,25,25,26,26,27,27,27,28,28,29,29,30,30,30,31,31,32,32,32,33,33,34)



Tableau2<-cbind(n,k_p_80,k_p_90,k_p_95,k_p_98,k_p_99,k_p_99.8,k_p_99.9)

Tableau2<-data.frame(Tableau2)
head(Tableau2)



```

# Grands échantillon (n > 100)

# Tableau 3:
Valeurs de u et de c pour le cas unilateral 


```{r}

N_V<- c (80,90,95,98,99,99.5,99.8,99.9)

u<- c(0.84162122,1.28155156,1.64485364,2.05374892,2.32634788,2.57582930,2.87816173,3.09023229)
c <- c( 0.75,0.903,1.087,1.3375,1.536,1.74,2.014,2.222)

Tableau3<-cbind(N_V,u,c)
Tableau3<-data.frame(Tableau3)
Tableau3



```



# Tableau 4:

Valeurs de u et de c pour le cas bilateral 


```{r}

N_V<- c (80,90,95,98,99,99.5,99.8,99.9)


u<- c(1.28155156,1.64485364,1.95996400,2.32634788,2.57582930,2.80703376,3.09023229,3.29052672)
c <- c( 0.903,1.087,1.274,1.536,1.74,1.945,2.222,2.437)

Tableau4<-cbind(N_V,u,c)
Tableau4<-data.frame(Tableau4)
Tableau4



```


```{r}

```


# Intervalle de confiance 

```{r}
## Cette fonction nous donne l'estimation ponctuelle de la mediane 
I_C<-function(X){
  X<-subset(X, !is.na(X))
  C<-as.numeric (readline(prompt = " Quel niveau de confiance parmi [80,90,95,98,99,99.5,99.8,99.9] ? "))
  I<-readline(prompt = "Unilateral ou bilateral ? : ")
  X<-sort(X)
  Me<-median(X)
  k<-NULL
  n<-length(X)
  Me<-median(X)
  Tab<-NULL
  
  if (  I== "bilateral"){
    if ( n <= 100 ) {
      Tab <- Tableau2
      if ( C==80) { k <- Tab[,2][n-4] }
      else if ( C==90) { k<-Tab[,3][n-4] }
      else if ( C==95 && n >5) { k<-Tab[,4][n-4] }
      else if ( C==98 && n >6 ) { k<-Tab[,5][n-4] }
      else if ( C==99 && n > 7) { k<-Tab[,6][n-4] }
      else if ( C==99.5 && n > 8 ) { k<-Tab[,7][n-4] }
      else if ( C==99.8 && n > 9 ) { k<-Tab[,8][n-4] }
      else if ( C==99.9 && n > 10 ) { k<-Tab[,9][n-4] }
      m <- n- k+1
      T1 <- X[k]
      T2 <- X[m]
      }
    else {
      Tab<-Tableau4
      if ( C==80 ) {
        u <- Tab[,2][1]
        c<- Tab[,3][1]
        }
      else if ( C==90) {
        u <- Tab[,2][2]
        c<- Tab[,3][2] 
        }
      else if ( C==95) {
        u <- Tab[,2][3]
        c<- Tab[,3][3] 
        }
      else if ( C==98) {
        u <- Tab[,2][4]
        c<- Tab[,3][4] 
        }
      else if ( C==99) {
        u <- Tab[,2][5]
        c<- Tab[,3][5]  
        }
      else if ( C==99.5) {
        u <- Tab[,2][6]
        c<- Tab[,2][6] 
        }
      else if ( C==99.8) {
        u <- Tab[,2][7]
        c<- Tab[,3][7]  
        }
      else if ( C==99.9) {
        u <- Tab[,2][8]
        c<- Tab[,3][8]  
        }
      y<-function ()  {
        return (0.5*(n+1-u*(1+0.4/n)*sqrt(n-c)))
        }
      k <-floor(y())
      m <- n- k+1
      T1 <- X[k]
      T2 <- X[m]
      print (n)
      print (c)
      print (u)
    }
    
     M<-cbind(T1,Me,T2)
    colnames(M)<- c("Limite inferieure :", " Estimation ponctuelle","Limite superieur :")
    return (M)}
  
  else if( I=="unilateral") { 
    if ( n <= 100 ) {
      Tab <- Tableau1
      if (C==80) { k <- Tab[,2][n-4] }
      else if ( C==90) { k<-Tab[,3][n-4] }
      else if ( C==95) { k<-Tab[,4][n-4] }
      else if ( C==98 && n >5 ) { k<-Tab[,5][n-4] }
      else if ( C==99 && n > 6) { k<-Tab[,6][n-4] }
      else if ( C==99.5 && n > 7 ) { k<-Tab[,7][n-4] }
      else if ( C==99.8 && n > 8 ) { k<-Tab[,8][n-4] }
      else if ( C==99.9 && n > 9 ) { k<-Tab[,9][n-4] }
      m <- n- k+1
      T1 <- X[k]
      T2 <- X[m]
      
    }
    
    else {
      Tab<-Tableau3
      if ( C==80 ) { 
        u <- Tab[,2][1]
        c<- Tab[,3][1]
        }
      else if ( C==90) {
        u <- Tab[,2][2]
        c<- Tab[,3][2] 
        }
      else if ( C==95) {
        u <- Tab[,2][3]
        c<- Tab[,3][3] 
        }
      else if ( C==98) {
      u <- Tab[,2][4]
      c<- Tab[,3][4] 
      }
      else if ( C==99) {
      u <- Tab[,2][5]
      c<- Tab[,3][5]  
      }
      else if ( C==99.5) {
      u <- Tab[,2][6]
      c<- Tab[,2][6] 
      }
      else if ( C==99.8) {
      u <- Tab[,2][7]
      c<- Tab[,3][7]  
      }
      else if ( C==99.9) {
      u <- Tab[,2][8]
      c<- Tab[,3][8]  
      }
      y<-function ()  { 
        return (0.5*(n+1-u*(1+0.4/n)*sqrt(n-c)))
      }
     
      k <-floor(y())
      T1 <- X[k]
      m<-n-k+1
      T2 <- X[m]
    } 
    M<-cbind(T1,Me,T2)
    colnames(M)<- c("Limite inferieure vaut:", "Estimation ponctuelle de la médiane vaut","Limite de confiance superieur vaut:")
    print ("Limite de confiance inferieure (inf) ou superieur (sup)")
    Ip<-readline(prompt = "inf ou sup ? : ")
    if (Ip=="inf") {return (M[,1:2])}
    else if (Ip=="sup") {return ( M[,2:3])}
    else { return  (" Ecrivez bien inf ou sup")}
    return (M)}
    else if (I!="unilateral" && I!="bilateral") { return ( "Intervalle à revoir")}
}


```





```{r}

XX<- c(31.3,33.3,33.5,35.6,36.0,36.2,36.5,37.5,37.8,37.9,38.8,39.1,40.3,40.4,40.8,
41.0,41.8,42.4,42.9,43.1,43.2,43.5,43.9,43.9,44.0,44.2,44.2,44.5,44.7,44.7,
45.0,45.6,46.0,46.0,46.1,46.1,46.3,46.3,46.3,46.4,46.5,46.7,47.1,47.1,47.1,
47.2,47.3,47.4,47.5,47.5,47.8,47.8,47.9,47.9,48.0,48.0,48.2,48.2,48.3,48.3,
48.3,48.5,48.6,48.6,48.6,48.6,48.8,48.9,48.9,48.9,49.0,49.0,49.1,49.1,49.1,
49.1,49.2,49.2,49.3,49.4,49.4,49.4,49.4,49.5,49.5,49.6,49.7,49.9,49.9,50.0,
50.1,50.2,50.2,50.3,50.3,50.3,50.5,50.7,50.8,50.9,50.9,51.0,51.0,51.2,51.4,
51.4,51.4,51.6,51.6,51.8,52.0,52.2,52.2,52.4,52.5,52.6,52.8,52.9,53.2,53.3)
#I_C(XX)
    
```

# Exemple de la norme

```{r}

X<- c(57.5,77.8,88,96.9,98.4,100.4,100.8,102.1,103.3,103.4,105.3,105.4,122.6,139.3,143.9,148,151.3,161.1,161.2,161.2,162.4,162.7,163.1,176.8)
#I_C(X)

```

# Application de la norme sur les échantillon

# importation de nos differentes données:
```{r}

Data <- read.csv( "Data_Mars_2017.csv",
                  head= TRUE,
                  sep= ';')
Data <- read.csv( "Data_Mars_2017.csv",head= TRUE,sep= ';')
#head(Data)
df_juin <- read.csv("Data_Juin_2017.csv", head = TRUE, sep = ";")
#head(df_juin)
library(xlsx)
df_Tio2<- read.xlsx( "Data_TiO2NP_JN_090318.xlsx", head= TRUE, sheetIndex=1)
#head(df_Tio2)
df_cc2<- read.csv( "dataCC2.csv", head= TRUE, sep =';')
#head(df_cc2)
df<- read.csv("RésultatsCEAStatt.csv", head= TRUE, sep = ';')
#head(df)
```

# Data Mars 2017

```{r}


CG_Freedent<-subset(Data[,1], !is.na(Data[,1]))
Ceo2.4<-subset(Data[,2], !is.na(Data[,2]))
R711<-subset(Data[,3], !is.na(Data[,3]))
Tio2<-subset(Data[,4], !is.na(Data[,4]))
length(CG_Freedent)
length(Ceo2.4)
length(R711)
length(Tio2)
#summary(Data)
#I_C(CG_Freedent)
#I_C(Ceo2.4)
#I_C(R711)
#I_C(Tio2)

```


```{r}
EVA<-subset(df_juin[,1], !is.na(df_juin[,1]))
CAM9080<-subset(df_juin[,2], !is.na(df_juin[,2]))
CAM9060<-subset(df_juin[,3], !is.na(df_juin[,3]))
R711<-subset(df_juin[,4], !is.na(df_juin[,4]))
AluC<-subset(df_juin[,5], !is.na(df_juin[,5]))
A200<-subset(df_juin[,6], !is.na(df_juin[,6]))

#I_C(EVA)
#I_C(CAM9080)
#I_C(CAM9060)
#I_C(R711)
#I_C(AluC)
#I_C(A200)
```


```{r}

X27.CG4x400<-subset(df_Tio2[,1], !is.na(df_Tio2[,1]))
x2<-subset(df_Tio2$X31.CG4x400c, !is.na(df_Tio2$X31.CG4x400c))
X37.CG4x300<-subset(df_Tio2[,3], !is.na(df_Tio2[,3]))
X39.CG4x200<-subset(df_Tio2[,4], !is.na(df_Tio2[,4]))
X56.CG6x400<-subset(df_Tio2[,5], !is.na(df_Tio2[,5]))
X64.CG6x200<-subset(df_Tio2[,6], !is.na(df_Tio2[,6]))
X23.A81x90x80<-subset(df_Tio2[,7], !is.na(df_Tio2[,7]))
X27.A8.2x50x50<-subset(df_Tio2[,8], !is.na(df_Tio2[,8]))
X46.CG7x1500x30<-subset(df_Tio2[,9], !is.na(df_Tio2[,9]))
X50.MM4x1300x200<-subset(df_Tio2[,10], !is.na(df_Tio2[,10]))
X53.MM5x1000x300<-subset(df_Tio2[,11], !is.na(df_Tio2[,11]))




#I_C(X27.CG4x400)
#I_C(x2)
#I_C(X37.CG4x300)
#I_C(X39.CG4x200)
#I_C(X56.CG6x400)
#I_C(X64.CG6x200)
#I_C(X23.A81x90x80)
#I_C(X27.A8.2x50x50)
#I_C(X46.CG7x1500x30)
#I_C(X50.MM4x1300x200)
#I_C(X53.MM5x1000x300)
#head(df_Tio2)

```


```{r}
A200.PLL<-subset(df_cc2[,1], !is.na(df_cc2[,1]))
AluC<-subset(df_cc2[,2], !is.na(df_cc2[,2]))
Bohemite_9060<-subset(df_cc2[,3], !is.na(df_cc2[,3]))
Bohemite_9080<-subset(df_cc2[,4], !is.na(df_cc2[,4]))

#I_C(A200.PLL)
#I_C(AluC)
#I_C(Bohemite_9060)
#I_C(Bohemite_9080)

```


```{r}

Ag.2min.CEA<-subset(df[,1], !is.na(df[,1]))
Au.BBI.CEA<-subset(df[,2], !is.na(df[,2]))
Au.JFH.PH6.CEA<-subset(df[,3], !is.na(df[,3]))
Au.JFH.PH8.CEA<-subset(df[,4], !is.na(df[,4]))
CeO2.4.CEA<-subset(df[,5], !is.na(df[,5]))
SiO2.NEXSIL35A.CEA<-subset(df[,6], !is.na(df[,6]))
TiO2.JFH.CEA<-subset(df[,7], !is.na(df[,7]))
ZnO.2.CEA<-subset(df[,8], !is.na(df[,8]))
B3.CEA<-subset(df[,9], !is.na(df[,9]))
B10.CEA<-subset(df[,10], !is.na(df[,10]))
Hematite.CEA<-subset(df[,11], !is.na(df[,11]))
B6.CEA<-subset(df[,12], !is.na(df[,12]))
B9.CEA<-subset(df[,13], !is.na(df[,13]))
Ni.OH.2.CEA<-subset(df[,14], !is.na(df[,14]))



#I_C(Ag.2min.CEA)                    
#I_C(Au.BBI.CEA)
#I_C(Au.JFH.PH6.CEA)
#I_C(Au.JFH.PH8.CEA)
#I_C(CeO2.4.CEA)
#I_C(SiO2.NEXSIL35A.CEA)
#I_C(TiO2.JFH.CEA)
#I_C(ZnO.2.CEA)
#I_C(B3.CEA)
#I_C(B10.CEA)
#I_C(Hematite.CEA)
#I_C(B6.CEA)
#I_C(B9.CEA)
#I_C(Ni.OH.2.CEA)



```


```{r}


```




```{r}
library(xlsx)
Df<-df_Tio2<- read.xlsx( "data_TiO2FeretMin.xlsx", head= TRUE, sheetIndex=1)
head(Df)

```


```{r}
M<-1e5
df1 <- subset(Df[,1],
              !is.na(Df[,1]))

M1<-M_realisation_(df1,M)

y1<-Median_(M1)
Me1<- Estimation_(y1) 
colnames(Me1)<- "TiO2Diametre1"
rownames(Me1)<-c("M",
                 "Ecart_type",
                 " born_inf", 
                 " born_sup")
Me1<-data.frame(Me1)
df2 <- subset(Df[,2],
              !is.na(Df[,2]))
M2<-M_realisation_(df2,M)
y2<-Median_(M2)
Me2<- Estimation_(y2) 
colnames(Me2)<- "TiO2Diametre2"
rownames(Me2)<-c("M",
                 "Ecart_type",
                 " born_inf", 
                 " born_sup")
Me2<-data.frame(Me2)

df3 <- subset(Df[,3],
              !is.na(Df[,3]))

M3<-M_realisation_(df3,M)
y3<-Median_(M3)
DF<-rbind(M3,y3) 
Me3<-Estimation_(y3) 
colnames(Me3)<- "TiO2Diametre3"
rownames(Me3)<-c("M",
                 "Ecart_type",
                 " born_inf", 
                 " born_sup")
Me3<-data.frame(Me3)

recap<-cbind(Me1,Me2,Me3)
recap



```


```{r}

#I_C(Df[,3])
TiO2Diametre1<-c(141.62,114.593,103.545)
TiO2Diametre2<-c(103.0405,96.8636,106.845)
TiO2Diametre3<-c( 107.03,100.334 ,113.419)
recap_norm<-cbind(TiO2Diametre1,TiO2Diametre2,TiO2Diametre3)
rownames(recap_norm)<-c("M","lim_inf", 
                 "lim_sup")

recap_norm
```



```{r}

f<-ecdf(Df$TiO2Diametre1)
f2<-ecdf(Df$TiO2Diametre2)
f3<-ecdf(Df$TiO2Diametre3)

plot(f, col= "red", main=NA, xlab= "Médiane (nm)")
plot(f2, col="blue", add=T)
plot(f3, col=" grey", add=T)
abline( v=recap[1,1],h=0.5 , col= "red", lty=1, lwd=2)
abline( v=recap[1,2], h=0.5  , col= "blue",lty=2, lwd=2)
abline( v= recap[1,3], h=0.5   , col= "grey")


legend('right', c('Tio2Diametre1', 'Tio2Diametre2', 'Tio2Diametre3'), fill=c("red", "blue", " grey" ), border=NA)

```


```{r}


df1 <- subset(Df[,4],
              !is.na(Df[,4]))

M1<-M_realisation_(df1,M)
y1<-Median_(M1)
Me1<- Estimation_(y1) 
colnames(Me1)<- "TiO2FeretMin1"
rownames(Me1)<-c("M",
                 "Ecart_type",
                 " born_inf", 
                 " born_sup")
Me1<-data.frame(Me1)


df2 <- subset(Df[,5],
              !is.na(Df[,5]))
M2<-M_realisation_(df2,M)
y2<-Median_(M2)
Me2<- Estimation_(y2) 
colnames(Me2)<- "TiO2FeretMin2"
rownames(Me2)<-c("M",
                 "Ecart_type",
                 " born_inf", 
                 " born_sup")
Me2<-data.frame(Me2)

df3 <- subset(Df[,6],
              !is.na(Df[,6]))
M3<-M_realisation_(df3,M)
y3<-Median_(M3)
Me3<- Estimation_(y3) 
colnames(Me3)<- "TiO2FeretMin3"
rownames(Me3)<-c("M",
                 "Ecart_type",
                 " born_inf", 
                 " born_sup")
Me3<-data.frame(Me3)

recap_<-cbind(Me1,Me2,Me3)
recap_
```


```{r}

TiO2FeretMin1<-c( 103.267,97.685,106.518)
TiO2FeretMin2<-c(95.92115 ,93.5736,100.476)
TiO2FeretMin3<-c( 100.488,95.4631 , 108.849)
recap1_norm<-cbind(TiO2FeretMin1,TiO2FeretMin2,TiO2FeretMin3)
rownames(recap1_norm)<-c("M","lim_inf", 
                 "lim_sup")
recap1_norm
```


```{r}

f<-ecdf(Df$TiO2FeretMin1)
f2<-ecdf(Df$TiO2FeretMin2)
f3<-ecdf(Df$TiO2FeretMin3)

plot(f, col= "red", main=NA, xlab= "Médiane (nm)")
plot(f2, col="blue", add=T)
plot(f3, col=" grey", add=T)
abline( v=recap_[1,1],h=0.5 , col= "red", lty=1, lwd=2)
abline( v=recap_[1,2], h=0.5  , col= "blue",lty=2, lwd=2)
abline( v= recap_[1,3], h=0.5   , col= "grey")

legend('right', c('Tio2FeretMin1', 'Tio2FeretMin2', 'Tio2FeretMin3'), fill=c("red", "blue", " grey" ), border=NA)


```



```{r pressure, echo=FALSE}

```

